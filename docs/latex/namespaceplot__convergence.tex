\hypertarget{namespaceplot__convergence}{}\doxysection{plot\+\_\+convergence Namespace Reference}
\label{namespaceplot__convergence}\index{plot\_convergence@{plot\_convergence}}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{namespaceplot__convergence_a87393486292e635e9ba0f41aa3187f9b}{get\+\_\+step\+\_\+from\+\_\+filename}} (str filepath)
\item 
np.\+ndarray \mbox{\hyperlink{namespaceplot__convergence_a9d194ce0680046fcab4dc84a30985795}{compute\+\_\+analytical\+\_\+u\+\_\+at\+\_\+x\+\_\+faces}} (np.\+ndarray points, float t, float h)
\item 
np.\+ndarray \mbox{\hyperlink{namespaceplot__convergence_a6c2284685104840a9071e4012cf24cd4}{compute\+\_\+analytical\+\_\+v\+\_\+at\+\_\+y\+\_\+faces}} (np.\+ndarray points, float t, float h)
\item 
np.\+ndarray \mbox{\hyperlink{namespaceplot__convergence_aeaba55980f3984a336b6a0808e21f13b}{compute\+\_\+analytical\+\_\+w\+\_\+at\+\_\+z\+\_\+faces}} (np.\+ndarray points, float t, float h)
\item 
np.\+ndarray \mbox{\hyperlink{namespaceplot__convergence_afefebe4bf93b54608bcc4eb36d03d587}{compute\+\_\+analytical\+\_\+p\+\_\+at\+\_\+centers}} (np.\+ndarray points, float t)
\item 
float \mbox{\hyperlink{namespaceplot__convergence_a86f4b7292316d5209cdb9f9a8729a3a1}{calculate\+\_\+l2\+\_\+rms}} (np.\+ndarray data)
\item 
float \mbox{\hyperlink{namespaceplot__convergence_a29cf4ff6696e41332aaa9418b382885e}{calculate\+\_\+l2\+\_\+rms\+\_\+error}} (np.\+ndarray field\+\_\+numerical, np.\+ndarray field\+\_\+analytical)
\item 
def \mbox{\hyperlink{namespaceplot__convergence_a73e0b3f40b0a1731c5159499b15d4066}{plot\+\_\+convergence}} (list h\+\_\+values, dict error\+\_\+data, str title, str save\+\_\+filename)
\item 
def \mbox{\hyperlink{namespaceplot__convergence_a619471dc6a944337f477b6a70bb21773}{run\+\_\+analysis}} (custom\+\_\+simulations=None)
\end{DoxyCompactItemize}
\doxysubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
list \mbox{\hyperlink{namespaceplot__convergence_a0b267e5e75f04fd7a7c8c883df64be8b}{SIMULATIONS}}
\item 
int \mbox{\hyperlink{namespaceplot__convergence_ac69ad50acd795edd6bb46dbfd98082da}{DOMAIN\+\_\+\+LENGTH\+\_\+X}} = 6
\item 
float \mbox{\hyperlink{namespaceplot__convergence_af7596294482c5833f5b57644f839427e}{DT}} = 0.\+001
\item 
string \mbox{\hyperlink{namespaceplot__convergence_a8a5d9e2af61f78e3bc89b22c898bf8ec}{VELOCITY\+\_\+\+FIELD\+\_\+\+NAME}} = \char`\"{}velocity\char`\"{}
\item 
string \mbox{\hyperlink{namespaceplot__convergence_a6b7feb52a97db1f3fdfee7b06c98f47e}{PRESSURE\+\_\+\+FIELD\+\_\+\+NAME}} = \char`\"{}pressure\char`\"{}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}This script performs a spatial convergence analysis for a Method of
Manufactured Solutions (MMS) test.

It reads multiple VTK files, each from a simulation with a different
grid resolution. For each file, it computes the L2 RMS error
of velocity components (u, v, w) and pressure (p) against a
known analytical solution.

This version is adapted for staggered grid solvers where the VTK output
is co-located (e.g., at cell centers). It compares the numerical
co-located data against the analytical solution evaluated at the
appropriate staggered locations (e.g., cell faces).

Script modified from a previous version to:
1. Use only L2 RMS (absolute) errors.
2. Add O(h) and O(h^2) reference lines.
3. Translate all comments and outputs to English.
4. Remove all divergence calculations.
5. Save plots to high-definition image files instead of showing them.
\end{DoxyVerb}
 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{namespaceplot__convergence_a86f4b7292316d5209cdb9f9a8729a3a1}\label{namespaceplot__convergence_a86f4b7292316d5209cdb9f9a8729a3a1}} 
\index{plot\_convergence@{plot\_convergence}!calculate\_l2\_rms@{calculate\_l2\_rms}}
\index{calculate\_l2\_rms@{calculate\_l2\_rms}!plot\_convergence@{plot\_convergence}}
\doxysubsubsection{\texorpdfstring{calculate\_l2\_rms()}{calculate\_l2\_rms()}}
{\footnotesize\ttfamily  float plot\+\_\+convergence.\+calculate\+\_\+l2\+\_\+rms (\begin{DoxyParamCaption}\item[{np.\+ndarray}]{data }\end{DoxyParamCaption})}

\begin{DoxyVerb}Calculates the L2 Root Mean Square (RMS) value of a data field.
This works for both scalar (N,) and vector (N, 3) fields.
\end{DoxyVerb}
 Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceplot__convergence_a86f4b7292316d5209cdb9f9a8729a3a1_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespaceplot__convergence_a29cf4ff6696e41332aaa9418b382885e}\label{namespaceplot__convergence_a29cf4ff6696e41332aaa9418b382885e}} 
\index{plot\_convergence@{plot\_convergence}!calculate\_l2\_rms\_error@{calculate\_l2\_rms\_error}}
\index{calculate\_l2\_rms\_error@{calculate\_l2\_rms\_error}!plot\_convergence@{plot\_convergence}}
\doxysubsubsection{\texorpdfstring{calculate\_l2\_rms\_error()}{calculate\_l2\_rms\_error()}}
{\footnotesize\ttfamily  float plot\+\_\+convergence.\+calculate\+\_\+l2\+\_\+rms\+\_\+error (\begin{DoxyParamCaption}\item[{np.\+ndarray}]{field\+\_\+numerical,  }\item[{np.\+ndarray}]{field\+\_\+analytical }\end{DoxyParamCaption})}

\begin{DoxyVerb}Calculates the L2 RMS of the error (field_numerical - field_analytical).
This is now an absolute error (the RMS norm of the error field).
\end{DoxyVerb}
 Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceplot__convergence_a29cf4ff6696e41332aaa9418b382885e_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceplot__convergence_a29cf4ff6696e41332aaa9418b382885e_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespaceplot__convergence_afefebe4bf93b54608bcc4eb36d03d587}\label{namespaceplot__convergence_afefebe4bf93b54608bcc4eb36d03d587}} 
\index{plot\_convergence@{plot\_convergence}!compute\_analytical\_p\_at\_centers@{compute\_analytical\_p\_at\_centers}}
\index{compute\_analytical\_p\_at\_centers@{compute\_analytical\_p\_at\_centers}!plot\_convergence@{plot\_convergence}}
\doxysubsubsection{\texorpdfstring{compute\_analytical\_p\_at\_centers()}{compute\_analytical\_p\_at\_centers()}}
{\footnotesize\ttfamily  np.\+ndarray plot\+\_\+convergence.\+compute\+\_\+analytical\+\_\+p\+\_\+at\+\_\+centers (\begin{DoxyParamCaption}\item[{np.\+ndarray}]{points,  }\item[{float}]{t }\end{DoxyParamCaption})}

\begin{DoxyVerb}Computes analytical pressure.
Assumes 'points' are cell centers (i, j, k) and evaluates p there.
\end{DoxyVerb}
 Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceplot__convergence_afefebe4bf93b54608bcc4eb36d03d587_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespaceplot__convergence_a9d194ce0680046fcab4dc84a30985795}\label{namespaceplot__convergence_a9d194ce0680046fcab4dc84a30985795}} 
\index{plot\_convergence@{plot\_convergence}!compute\_analytical\_u\_at\_x\_faces@{compute\_analytical\_u\_at\_x\_faces}}
\index{compute\_analytical\_u\_at\_x\_faces@{compute\_analytical\_u\_at\_x\_faces}!plot\_convergence@{plot\_convergence}}
\doxysubsubsection{\texorpdfstring{compute\_analytical\_u\_at\_x\_faces()}{compute\_analytical\_u\_at\_x\_faces()}}
{\footnotesize\ttfamily  np.\+ndarray plot\+\_\+convergence.\+compute\+\_\+analytical\+\_\+u\+\_\+at\+\_\+x\+\_\+faces (\begin{DoxyParamCaption}\item[{np.\+ndarray}]{points,  }\item[{float}]{t,  }\item[{float}]{h }\end{DoxyParamCaption})}

\begin{DoxyVerb}Computes analytical u-velocity.
Assumes 'points' are cell centers (i, j, k).
Evaluates 'u' at the x-face center (i+0.5, j, k)
by shifting x coordinates by +h/2.
\end{DoxyVerb}
 Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceplot__convergence_a9d194ce0680046fcab4dc84a30985795_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespaceplot__convergence_a6c2284685104840a9071e4012cf24cd4}\label{namespaceplot__convergence_a6c2284685104840a9071e4012cf24cd4}} 
\index{plot\_convergence@{plot\_convergence}!compute\_analytical\_v\_at\_y\_faces@{compute\_analytical\_v\_at\_y\_faces}}
\index{compute\_analytical\_v\_at\_y\_faces@{compute\_analytical\_v\_at\_y\_faces}!plot\_convergence@{plot\_convergence}}
\doxysubsubsection{\texorpdfstring{compute\_analytical\_v\_at\_y\_faces()}{compute\_analytical\_v\_at\_y\_faces()}}
{\footnotesize\ttfamily  np.\+ndarray plot\+\_\+convergence.\+compute\+\_\+analytical\+\_\+v\+\_\+at\+\_\+y\+\_\+faces (\begin{DoxyParamCaption}\item[{np.\+ndarray}]{points,  }\item[{float}]{t,  }\item[{float}]{h }\end{DoxyParamCaption})}

\begin{DoxyVerb}Computes analytical v-velocity.
Assumes 'points' are cell centers (i, j, k).
Evaluates 'v' at the y-face center (i, j+0.5, k)
by shifting y coordinates by +h/2.
\end{DoxyVerb}
 Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceplot__convergence_a6c2284685104840a9071e4012cf24cd4_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespaceplot__convergence_aeaba55980f3984a336b6a0808e21f13b}\label{namespaceplot__convergence_aeaba55980f3984a336b6a0808e21f13b}} 
\index{plot\_convergence@{plot\_convergence}!compute\_analytical\_w\_at\_z\_faces@{compute\_analytical\_w\_at\_z\_faces}}
\index{compute\_analytical\_w\_at\_z\_faces@{compute\_analytical\_w\_at\_z\_faces}!plot\_convergence@{plot\_convergence}}
\doxysubsubsection{\texorpdfstring{compute\_analytical\_w\_at\_z\_faces()}{compute\_analytical\_w\_at\_z\_faces()}}
{\footnotesize\ttfamily  np.\+ndarray plot\+\_\+convergence.\+compute\+\_\+analytical\+\_\+w\+\_\+at\+\_\+z\+\_\+faces (\begin{DoxyParamCaption}\item[{np.\+ndarray}]{points,  }\item[{float}]{t,  }\item[{float}]{h }\end{DoxyParamCaption})}

\begin{DoxyVerb}Computes analytical w-velocity.
Assumes 'points' are cell centers (i, j, k).
Evaluates 'w' at the z-face center (i, j, k+0.5)
by shifting z coordinates by +h/2.
\end{DoxyVerb}
 Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceplot__convergence_aeaba55980f3984a336b6a0808e21f13b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespaceplot__convergence_a87393486292e635e9ba0f41aa3187f9b}\label{namespaceplot__convergence_a87393486292e635e9ba0f41aa3187f9b}} 
\index{plot\_convergence@{plot\_convergence}!get\_step\_from\_filename@{get\_step\_from\_filename}}
\index{get\_step\_from\_filename@{get\_step\_from\_filename}!plot\_convergence@{plot\_convergence}}
\doxysubsubsection{\texorpdfstring{get\_step\_from\_filename()}{get\_step\_from\_filename()}}
{\footnotesize\ttfamily  int plot\+\_\+convergence.\+get\+\_\+step\+\_\+from\+\_\+filename (\begin{DoxyParamCaption}\item[{str}]{filepath }\end{DoxyParamCaption})}

\begin{DoxyVerb}Parses a filename (e.g., "sim_0319.vtk") and extracts
the step number (319).
\end{DoxyVerb}
 Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceplot__convergence_a87393486292e635e9ba0f41aa3187f9b_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespaceplot__convergence_a73e0b3f40b0a1731c5159499b15d4066}\label{namespaceplot__convergence_a73e0b3f40b0a1731c5159499b15d4066}} 
\index{plot\_convergence@{plot\_convergence}!plot\_convergence@{plot\_convergence}}
\index{plot\_convergence@{plot\_convergence}!plot\_convergence@{plot\_convergence}}
\doxysubsubsection{\texorpdfstring{plot\_convergence()}{plot\_convergence()}}
{\footnotesize\ttfamily def plot\+\_\+convergence.\+plot\+\_\+convergence (\begin{DoxyParamCaption}\item[{list}]{h\+\_\+values,  }\item[{dict}]{error\+\_\+data,  }\item[{str}]{title,  }\item[{str}]{save\+\_\+filename }\end{DoxyParamCaption})}

\mbox{\Hypertarget{namespaceplot__convergence_a619471dc6a944337f477b6a70bb21773}\label{namespaceplot__convergence_a619471dc6a944337f477b6a70bb21773}} 
\index{plot\_convergence@{plot\_convergence}!run\_analysis@{run\_analysis}}
\index{run\_analysis@{run\_analysis}!plot\_convergence@{plot\_convergence}}
\doxysubsubsection{\texorpdfstring{run\_analysis()}{run\_analysis()}}
{\footnotesize\ttfamily def plot\+\_\+convergence.\+run\+\_\+analysis (\begin{DoxyParamCaption}\item[{}]{custom\+\_\+simulations = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Main function to loop through simulations, compute errors, and plot.
If custom_simulations is provided, it uses that list instead of the global SIMULATIONS.
\end{DoxyVerb}
 Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceplot__convergence_a619471dc6a944337f477b6a70bb21773_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespaceplot__convergence_a619471dc6a944337f477b6a70bb21773_icgraph}
\end{center}
\end{figure}


\doxysubsection{Variable Documentation}
\mbox{\Hypertarget{namespaceplot__convergence_ac69ad50acd795edd6bb46dbfd98082da}\label{namespaceplot__convergence_ac69ad50acd795edd6bb46dbfd98082da}} 
\index{plot\_convergence@{plot\_convergence}!DOMAIN\_LENGTH\_X@{DOMAIN\_LENGTH\_X}}
\index{DOMAIN\_LENGTH\_X@{DOMAIN\_LENGTH\_X}!plot\_convergence@{plot\_convergence}}
\doxysubsubsection{\texorpdfstring{DOMAIN\_LENGTH\_X}{DOMAIN\_LENGTH\_X}}
{\footnotesize\ttfamily int plot\+\_\+convergence.\+DOMAIN\+\_\+\+LENGTH\+\_\+X = 6}

\mbox{\Hypertarget{namespaceplot__convergence_af7596294482c5833f5b57644f839427e}\label{namespaceplot__convergence_af7596294482c5833f5b57644f839427e}} 
\index{plot\_convergence@{plot\_convergence}!DT@{DT}}
\index{DT@{DT}!plot\_convergence@{plot\_convergence}}
\doxysubsubsection{\texorpdfstring{DT}{DT}}
{\footnotesize\ttfamily float plot\+\_\+convergence.\+DT = 0.\+001}

\mbox{\Hypertarget{namespaceplot__convergence_a6b7feb52a97db1f3fdfee7b06c98f47e}\label{namespaceplot__convergence_a6b7feb52a97db1f3fdfee7b06c98f47e}} 
\index{plot\_convergence@{plot\_convergence}!PRESSURE\_FIELD\_NAME@{PRESSURE\_FIELD\_NAME}}
\index{PRESSURE\_FIELD\_NAME@{PRESSURE\_FIELD\_NAME}!plot\_convergence@{plot\_convergence}}
\doxysubsubsection{\texorpdfstring{PRESSURE\_FIELD\_NAME}{PRESSURE\_FIELD\_NAME}}
{\footnotesize\ttfamily string plot\+\_\+convergence.\+PRESSURE\+\_\+\+FIELD\+\_\+\+NAME = \char`\"{}pressure\char`\"{}}

\mbox{\Hypertarget{namespaceplot__convergence_a0b267e5e75f04fd7a7c8c883df64be8b}\label{namespaceplot__convergence_a0b267e5e75f04fd7a7c8c883df64be8b}} 
\index{plot\_convergence@{plot\_convergence}!SIMULATIONS@{SIMULATIONS}}
\index{SIMULATIONS@{SIMULATIONS}!plot\_convergence@{plot\_convergence}}
\doxysubsubsection{\texorpdfstring{SIMULATIONS}{SIMULATIONS}}
{\footnotesize\ttfamily list plot\+\_\+convergence.\+SIMULATIONS}

{\bfseries Initial value\+:}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 =  [}
\DoxyCodeLine{2 \{\textcolor{stringliteral}{"{}nx"{}}: 30, \textcolor{stringliteral}{"{}file"{}}: \textcolor{stringliteral}{"{}../output/n30simulation\_output\_0030.vtk"{}}\},}
\DoxyCodeLine{3 \{\textcolor{stringliteral}{"{}nx"{}}: 20, \textcolor{stringliteral}{"{}file"{}}: \textcolor{stringliteral}{"{}../output/n20simulation\_output\_0030.vtk"{}}\},}
\DoxyCodeLine{4 \textcolor{comment}{\# \{"{}nx"{}: 40, "{}file"{}: "{}../output/n40simulation\_output\_0030.vtk"{}\},}}
\DoxyCodeLine{5 \textcolor{comment}{\# \{"{}nx"{}: 45, "{}file"{}: "{}../output/n45simulation\_output\_0030.vtk"{}\},}}
\DoxyCodeLine{6 \textcolor{comment}{\# \{"{}nx"{}: 35, "{}file"{}: "{}../output/n35simulation\_output\_0030.vtk"{}\},}}
\DoxyCodeLine{7 \textcolor{comment}{\# \{"{}nx"{}: 60, "{}file"{}: "{}../output/n60simulation\_output\_0030.vtk"{}\},}}
\DoxyCodeLine{8 \textcolor{comment}{\# \{"{}nx"{}: 50, "{}file"{}: "{}../output/n50simulation\_output\_0030.vtk"{}\},}}
\DoxyCodeLine{9 \textcolor{comment}{\# \{"{}nx"{}: 80, "{}file"{}: "{}../output/n80simulation\_output\_0030.vtk"{}\},}}
\DoxyCodeLine{10 ]}

\end{DoxyCode}
\mbox{\Hypertarget{namespaceplot__convergence_a8a5d9e2af61f78e3bc89b22c898bf8ec}\label{namespaceplot__convergence_a8a5d9e2af61f78e3bc89b22c898bf8ec}} 
\index{plot\_convergence@{plot\_convergence}!VELOCITY\_FIELD\_NAME@{VELOCITY\_FIELD\_NAME}}
\index{VELOCITY\_FIELD\_NAME@{VELOCITY\_FIELD\_NAME}!plot\_convergence@{plot\_convergence}}
\doxysubsubsection{\texorpdfstring{VELOCITY\_FIELD\_NAME}{VELOCITY\_FIELD\_NAME}}
{\footnotesize\ttfamily string plot\+\_\+convergence.\+VELOCITY\+\_\+\+FIELD\+\_\+\+NAME = \char`\"{}velocity\char`\"{}}

