<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NSB Solver: include/core/Grid.hpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">NSB Solver
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="dir_3d69f64eaf81436fe2b22361382717e5.html">core</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Grid.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="Grid_8hpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#ifndef NSBSOLVER_GRID_HPP</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#define NSBSOLVER_GRID_HPP</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &lt;cstddef&gt;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="MpiEnv_8hpp.html">core/MpiEnv.hpp</a>&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160; </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno"><a class="line" href="Grid_8hpp.html#af6e03aaba31deefd41eb8d7ca6128c01">   10</a></span>&#160;<span class="keyword">enum class</span> <a class="code" href="Grid_8hpp.html#af6e03aaba31deefd41eb8d7ca6128c01">GridStaggering</a> {</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <a class="code" href="Grid_8hpp.html#af6e03aaba31deefd41eb8d7ca6128c01aa514377f27da15203c2393890f1b872e">CELL_CENTERED</a>, <a class="code" href="Grid_8hpp.html#af6e03aaba31deefd41eb8d7ca6128c01a065dd325784072eaf86ef9431ad7e067">FACE_CENTERED</a></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;};</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno"><a class="line" href="Grid_8hpp.html#a90e0015df12e0e71b9457e226d49c125">   15</a></span>&#160;<span class="keyword">using</span> <a class="code" href="Grid_8hpp.html#a90e0015df12e0e71b9457e226d49c125">GridPtr</a> = std::shared_ptr&lt;const struct Grid&gt;;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno"><a class="line" href="structGrid.html">   18</a></span>&#160;<span class="keyword">struct </span><a class="code" href="structGrid.html">Grid</a> {</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    <span class="comment">//==================================================================================================================</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    <span class="comment">//--- GLOBAL (DOMAIN) GRID INFO ------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="comment">//==================================================================================================================</span></div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="structGrid.html#a730fde210b6d4dd0f38ad9e84b504851">   23</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="structGrid.html#a730fde210b6d4dd0f38ad9e84b504851">Lx_glob</a>, <a class="code" href="structGrid.html#a781159ea5c1221fa762773382b2379be">Ly_glob</a>, <a class="code" href="structGrid.html#adfd015b3978a3dd58f1fe4daa0567eb5">Lz_glob</a>;</div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="structGrid.html#a00c9b075375377e49b337f014dde527d">   25</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structGrid.html#a00c9b075375377e49b337f014dde527d">Nx_glob</a>, <a class="code" href="structGrid.html#a513f0485d5d237374e53449b2c656d1a">Ny_glob</a>, <a class="code" href="structGrid.html#ad1c6b97e05c5dd3a7ae4c96d51b77c63">Nz_glob</a>; <span class="comment">// as input</span></div>
<div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="structGrid.html#a1f52441a37442b054bf153cc362cf2d8">   27</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> <a class="code" href="structGrid.html#a1f52441a37442b054bf153cc362cf2d8">dx</a>, <a class="code" href="structGrid.html#ac388777840b30765f83a8a135d7b0cec">dy</a>, <a class="code" href="structGrid.html#a229d6a7322d5d4ff446fd78468fef27b">dz</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <span class="comment">//==================================================================================================================</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <span class="comment">//--- LOCAL (CHUNK) GRID INFO --------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <span class="comment">//==================================================================================================================</span></div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="structGrid.html#a7f51b9f4262231b3e89f1b9169f83e1c">   33</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">size_t</span> <a class="code" href="structGrid.html#a7f51b9f4262231b3e89f1b9169f83e1c">Nx</a>, <a class="code" href="structGrid.html#aedbe6591ce1565b3bdece8af225e5015">Ny</a>, <a class="code" href="structGrid.html#a5165f82a832d9b1c2bd2156c3b6439d6">Nz</a>; <span class="comment">// derived, owned by this rank</span></div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="structGrid.html#a6f37c8f735275a95c496ce0e9309c44a">   35</a></span>&#160;<span class="comment"></span>    <span class="keywordtype">size_t</span> <a class="code" href="structGrid.html#a6f37c8f735275a95c496ce0e9309c44a">i_start</a>, <a class="code" href="structGrid.html#a1db9deea8539aa4b9f193efd3d440172">j_start</a>, <a class="code" href="structGrid.html#ab4073ab5f9f45cffcf9ec3059e61c5d3">k_start</a>;</div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="structGrid.html#a78c04584375f91cfa978ea0c9f76c111">   37</a></span>&#160;    <span class="keywordtype">size_t</span> <a class="code" href="structGrid.html#a78c04584375f91cfa978ea0c9f76c111">n_halo</a>;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    <a class="code" href="structGrid.html#a374223708b014cc2b96c2e6e5ef4abf7">Grid</a>(<span class="keywordtype">size_t</span> Nx_g, <span class="keywordtype">size_t</span> Ny_g, <span class="keywordtype">size_t</span> Nz_g,</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;         <span class="keywordtype">double</span> dx_, <span class="keywordtype">double</span> dy_, <span class="keywordtype">double</span> dz_);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="structGrid.html#a374223708b014cc2b96c2e6e5ef4abf7">Grid</a>(<span class="keywordtype">size_t</span> Nx_g, <span class="keywordtype">size_t</span> Ny_g, <span class="keywordtype">size_t</span> Nz_g,</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;         <span class="keywordtype">double</span> dx_, <span class="keywordtype">double</span> dy_, <span class="keywordtype">double</span> dz_,</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;         <span class="keyword">const</span> <a class="code" href="classMpiEnv.html">MpiEnv</a> &amp;env,</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;         <span class="keywordtype">size_t</span> <a class="code" href="structGrid.html#a78c04584375f91cfa978ea0c9f76c111">n_halo</a> = 2);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    <span class="keyword">static</span> std::pair&lt;size_t, size_t&gt; <a class="code" href="structGrid.html#ac9b2a8eafa59fe957bd84b9d3f84df7f">decompose1D</a>(<span class="keywordtype">size_t</span> N_glob, <span class="keywordtype">int</span> n_procs, <span class="keywordtype">int</span> proc_coord);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="structGrid.html#a8a5cf0c72f5be8a213d6e895494851e6">   84</a></span>&#160;    [[nodiscard]] <span class="keyword">inline</span> constexpr <span class="keywordtype">size_t</span> <a class="code" href="structGrid.html#a8a5cf0c72f5be8a213d6e895494851e6">globalSize</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="structGrid.html#a00c9b075375377e49b337f014dde527d">Nx_glob</a> * <a class="code" href="structGrid.html#a513f0485d5d237374e53449b2c656d1a">Ny_glob</a> * <a class="code" href="structGrid.html#ad1c6b97e05c5dd3a7ae4c96d51b77c63">Nz_glob</a>; }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno"><a class="line" href="structGrid.html#add6c8c9ea4bd708abfcbe875e85cd076">   90</a></span>&#160;    [[nodiscard]] <span class="keyword">inline</span> constexpr <span class="keywordtype">size_t</span> <a class="code" href="structGrid.html#add6c8c9ea4bd708abfcbe875e85cd076">size</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="structGrid.html#a7f51b9f4262231b3e89f1b9169f83e1c">Nx</a> * <a class="code" href="structGrid.html#aedbe6591ce1565b3bdece8af225e5015">Ny</a> * <a class="code" href="structGrid.html#a5165f82a832d9b1c2bd2156c3b6439d6">Nz</a>; }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno"><a class="line" href="structGrid.html#ae445b63d1d6af03452f1ffeb2f622d3d">   96</a></span>&#160;    [[nodiscard]] <span class="keyword">inline</span> constexpr <span class="keywordtype">size_t</span> <a class="code" href="structGrid.html#ae445b63d1d6af03452f1ffeb2f622d3d">sizeWithHalo</a>()<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="keywordflow">return</span> (<a class="code" href="structGrid.html#a7f51b9f4262231b3e89f1b9169f83e1c">Nx</a> + 2 * <a class="code" href="structGrid.html#a78c04584375f91cfa978ea0c9f76c111">n_halo</a>) * (<a class="code" href="structGrid.html#aedbe6591ce1565b3bdece8af225e5015">Ny</a> + 2 * <a class="code" href="structGrid.html#a78c04584375f91cfa978ea0c9f76c111">n_halo</a>) * (<a class="code" href="structGrid.html#a5165f82a832d9b1c2bd2156c3b6439d6">Nz</a> + 2 * <a class="code" href="structGrid.html#a78c04584375f91cfa978ea0c9f76c111">n_halo</a>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    }</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="structGrid.html#aa028931255914c6030565b59d2ec1be6">  107</a></span>&#160;    [[nodiscard]] <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="structGrid.html#aa028931255914c6030565b59d2ec1be6">to_x</a>(<span class="keywordtype">size_t</span> i, <a class="code" href="Grid_8hpp.html#af6e03aaba31deefd41eb8d7ca6128c01">GridStaggering</a> offset, <a class="code" href="MpiEnv_8hpp.html#ae3996976d8ffb3e58d88f58227473f8e">Axis</a> offsetAxis)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> i_glob = (double) (<a class="code" href="structGrid.html#a6f37c8f735275a95c496ce0e9309c44a">i_start</a> + i);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> i_offset = (offset == <a class="code" href="Grid_8hpp.html#af6e03aaba31deefd41eb8d7ca6128c01a065dd325784072eaf86ef9431ad7e067">GridStaggering::FACE_CENTERED</a> &amp;&amp; offsetAxis == <a class="code" href="MpiEnv_8hpp.html#ae3996976d8ffb3e58d88f58227473f8ea02129bb861061d1a052c592e2dc6b383">Axis::X</a>) ? 0.5 : 0.0;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keywordflow">return</span> (i_glob + i_offset) * <a class="code" href="structGrid.html#a1f52441a37442b054bf153cc362cf2d8">dx</a>;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    }</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno"><a class="line" href="structGrid.html#a591f8df86fb8e8f7986919e108f478ee">  120</a></span>&#160;    [[nodiscard]] <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="structGrid.html#a591f8df86fb8e8f7986919e108f478ee">to_y</a>(<span class="keywordtype">size_t</span> j, <a class="code" href="Grid_8hpp.html#af6e03aaba31deefd41eb8d7ca6128c01">GridStaggering</a> offset, <a class="code" href="MpiEnv_8hpp.html#ae3996976d8ffb3e58d88f58227473f8e">Axis</a> offsetAxis)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> j_glob = (double) (<a class="code" href="structGrid.html#a1db9deea8539aa4b9f193efd3d440172">j_start</a> + j);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> j_offset = (offset == <a class="code" href="Grid_8hpp.html#af6e03aaba31deefd41eb8d7ca6128c01a065dd325784072eaf86ef9431ad7e067">GridStaggering::FACE_CENTERED</a> &amp;&amp; offsetAxis == <a class="code" href="MpiEnv_8hpp.html#ae3996976d8ffb3e58d88f58227473f8ea57cec4137b614c87cb4e24a3d003a3e0">Axis::Y</a>) ? 0.5 : 0.0;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">return</span> (j_glob + j_offset) * <a class="code" href="structGrid.html#ac388777840b30765f83a8a135d7b0cec">dy</a>;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    }</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno"><a class="line" href="structGrid.html#a1e3ed400719b829d8d23344e227e4474">  133</a></span>&#160;    [[nodiscard]] <span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code" href="structGrid.html#a1e3ed400719b829d8d23344e227e4474">to_z</a>(<span class="keywordtype">size_t</span> k, <a class="code" href="Grid_8hpp.html#af6e03aaba31deefd41eb8d7ca6128c01">GridStaggering</a> offset, <a class="code" href="MpiEnv_8hpp.html#ae3996976d8ffb3e58d88f58227473f8e">Axis</a> offsetAxis)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> k_glob = (double) (<a class="code" href="structGrid.html#ab4073ab5f9f45cffcf9ec3059e61c5d3">k_start</a> + k);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> k_offset = (offset == <a class="code" href="Grid_8hpp.html#af6e03aaba31deefd41eb8d7ca6128c01a065dd325784072eaf86ef9431ad7e067">GridStaggering::FACE_CENTERED</a> &amp;&amp; offsetAxis == <a class="code" href="MpiEnv_8hpp.html#ae3996976d8ffb3e58d88f58227473f8ea21c2e59531c8710156d34a3c30ac81d5">Axis::Z</a>) ? 0.5 : 0.0;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">return</span> (k_glob + k_offset) * <a class="code" href="structGrid.html#a229d6a7322d5d4ff446fd78468fef27b">dz</a>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="structGrid.html#aae9c0e8104091f55bd0c172a0d0ae081">  144</a></span>&#160;    [[nodiscard]] <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="structGrid.html#aae9c0e8104091f55bd0c172a0d0ae081">hasMinBoundary</a>(<a class="code" href="MpiEnv_8hpp.html#ae3996976d8ffb3e58d88f58227473f8e">Axis</a> axis)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="keywordflow">if</span> (axis == <a class="code" href="MpiEnv_8hpp.html#ae3996976d8ffb3e58d88f58227473f8ea02129bb861061d1a052c592e2dc6b383">Axis::X</a>) <span class="keywordflow">return</span> <a class="code" href="structGrid.html#a6f37c8f735275a95c496ce0e9309c44a">i_start</a> == 0;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">if</span> (axis == <a class="code" href="MpiEnv_8hpp.html#ae3996976d8ffb3e58d88f58227473f8ea57cec4137b614c87cb4e24a3d003a3e0">Axis::Y</a>) <span class="keywordflow">return</span> <a class="code" href="structGrid.html#a1db9deea8539aa4b9f193efd3d440172">j_start</a> == 0;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="structGrid.html#ab4073ab5f9f45cffcf9ec3059e61c5d3">k_start</a> == 0;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    }</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno"><a class="line" href="structGrid.html#afd10d881b59bee4831fffda719ca035a">  155</a></span>&#160;    [[nodiscard]] <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="structGrid.html#afd10d881b59bee4831fffda719ca035a">hasMaxBoundary</a>(<a class="code" href="MpiEnv_8hpp.html#ae3996976d8ffb3e58d88f58227473f8e">Axis</a> axis)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordflow">if</span> (axis == <a class="code" href="MpiEnv_8hpp.html#ae3996976d8ffb3e58d88f58227473f8ea02129bb861061d1a052c592e2dc6b383">Axis::X</a>) <span class="keywordflow">return</span> (<a class="code" href="structGrid.html#a6f37c8f735275a95c496ce0e9309c44a">i_start</a> + <a class="code" href="structGrid.html#a7f51b9f4262231b3e89f1b9169f83e1c">Nx</a>) == <a class="code" href="structGrid.html#a00c9b075375377e49b337f014dde527d">Nx_glob</a>;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">if</span> (axis == <a class="code" href="MpiEnv_8hpp.html#ae3996976d8ffb3e58d88f58227473f8ea57cec4137b614c87cb4e24a3d003a3e0">Axis::Y</a>) <span class="keywordflow">return</span> (<a class="code" href="structGrid.html#a1db9deea8539aa4b9f193efd3d440172">j_start</a> + <a class="code" href="structGrid.html#aedbe6591ce1565b3bdece8af225e5015">Ny</a>) == <a class="code" href="structGrid.html#a513f0485d5d237374e53449b2c656d1a">Ny_glob</a>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">return</span> (<a class="code" href="structGrid.html#ab4073ab5f9f45cffcf9ec3059e61c5d3">k_start</a> + <a class="code" href="structGrid.html#a5165f82a832d9b1c2bd2156c3b6439d6">Nz</a>) == <a class="code" href="structGrid.html#ad1c6b97e05c5dd3a7ae4c96d51b77c63">Nz_glob</a>;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;};</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="preprocessor">#endif </span><span class="comment">// NSBSOLVER_GRID_HPP</span></div>
<div class="ttc" id="aGrid_8hpp_html_a90e0015df12e0e71b9457e226d49c125"><div class="ttname"><a href="Grid_8hpp.html#a90e0015df12e0e71b9457e226d49c125">GridPtr</a></div><div class="ttdeci">std::shared_ptr&lt; const struct Grid &gt; GridPtr</div><div class="ttdoc">Shared pointer type for Grid struct.</div><div class="ttdef"><b>Definition:</b> Grid.hpp:15</div></div>
<div class="ttc" id="aGrid_8hpp_html_af6e03aaba31deefd41eb8d7ca6128c01"><div class="ttname"><a href="Grid_8hpp.html#af6e03aaba31deefd41eb8d7ca6128c01">GridStaggering</a></div><div class="ttdeci">GridStaggering</div><div class="ttdoc">Enum describing the (possibly staggered) position of some points in a grid.</div><div class="ttdef"><b>Definition:</b> Grid.hpp:10</div></div>
<div class="ttc" id="aGrid_8hpp_html_af6e03aaba31deefd41eb8d7ca6128c01a065dd325784072eaf86ef9431ad7e067"><div class="ttname"><a href="Grid_8hpp.html#af6e03aaba31deefd41eb8d7ca6128c01a065dd325784072eaf86ef9431ad7e067">GridStaggering::FACE_CENTERED</a></div><div class="ttdeci">@ FACE_CENTERED</div></div>
<div class="ttc" id="aGrid_8hpp_html_af6e03aaba31deefd41eb8d7ca6128c01aa514377f27da15203c2393890f1b872e"><div class="ttname"><a href="Grid_8hpp.html#af6e03aaba31deefd41eb8d7ca6128c01aa514377f27da15203c2393890f1b872e">GridStaggering::CELL_CENTERED</a></div><div class="ttdeci">@ CELL_CENTERED</div></div>
<div class="ttc" id="aMpiEnv_8hpp_html"><div class="ttname"><a href="MpiEnv_8hpp.html">MpiEnv.hpp</a></div></div>
<div class="ttc" id="aMpiEnv_8hpp_html_ae3996976d8ffb3e58d88f58227473f8e"><div class="ttname"><a href="MpiEnv_8hpp.html#ae3996976d8ffb3e58d88f58227473f8e">Axis</a></div><div class="ttdeci">Axis</div><div class="ttdoc">Enum class representing the three coordinate axes.</div><div class="ttdef"><b>Definition:</b> MpiEnv.hpp:9</div></div>
<div class="ttc" id="aMpiEnv_8hpp_html_ae3996976d8ffb3e58d88f58227473f8ea02129bb861061d1a052c592e2dc6b383"><div class="ttname"><a href="MpiEnv_8hpp.html#ae3996976d8ffb3e58d88f58227473f8ea02129bb861061d1a052c592e2dc6b383">Axis::X</a></div><div class="ttdeci">@ X</div></div>
<div class="ttc" id="aMpiEnv_8hpp_html_ae3996976d8ffb3e58d88f58227473f8ea21c2e59531c8710156d34a3c30ac81d5"><div class="ttname"><a href="MpiEnv_8hpp.html#ae3996976d8ffb3e58d88f58227473f8ea21c2e59531c8710156d34a3c30ac81d5">Axis::Z</a></div><div class="ttdeci">@ Z</div></div>
<div class="ttc" id="aMpiEnv_8hpp_html_ae3996976d8ffb3e58d88f58227473f8ea57cec4137b614c87cb4e24a3d003a3e0"><div class="ttname"><a href="MpiEnv_8hpp.html#ae3996976d8ffb3e58d88f58227473f8ea57cec4137b614c87cb4e24a3d003a3e0">Axis::Y</a></div><div class="ttdeci">@ Y</div></div>
<div class="ttc" id="aclassMpiEnv_html"><div class="ttname"><a href="classMpiEnv.html">MpiEnv</a></div><div class="ttdoc">Class that encapsulates MPI environment and Cartesian topology management.</div><div class="ttdef"><b>Definition:</b> MpiEnv.hpp:16</div></div>
<div class="ttc" id="astructGrid_html"><div class="ttname"><a href="structGrid.html">Grid</a></div><div class="ttdoc">Struct to hold grid dimensions and spacing information along each direction.</div><div class="ttdef"><b>Definition:</b> Grid.hpp:18</div></div>
<div class="ttc" id="astructGrid_html_a00c9b075375377e49b337f014dde527d"><div class="ttname"><a href="structGrid.html#a00c9b075375377e49b337f014dde527d">Grid::Nx_glob</a></div><div class="ttdeci">size_t Nx_glob</div><div class="ttdoc">Number of grid points in the global grid in each direction.</div><div class="ttdef"><b>Definition:</b> Grid.hpp:25</div></div>
<div class="ttc" id="astructGrid_html_a1db9deea8539aa4b9f193efd3d440172"><div class="ttname"><a href="structGrid.html#a1db9deea8539aa4b9f193efd3d440172">Grid::j_start</a></div><div class="ttdeci">size_t j_start</div><div class="ttdef"><b>Definition:</b> Grid.hpp:35</div></div>
<div class="ttc" id="astructGrid_html_a1e3ed400719b829d8d23344e227e4474"><div class="ttname"><a href="structGrid.html#a1e3ed400719b829d8d23344e227e4474">Grid::to_z</a></div><div class="ttdeci">double to_z(size_t k, GridStaggering offset, Axis offsetAxis) const</div><div class="ttdoc">Converts a grid index to a physical coordinate along the Z-axis, considering staggering.</div><div class="ttdef"><b>Definition:</b> Grid.hpp:133</div></div>
<div class="ttc" id="astructGrid_html_a1f52441a37442b054bf153cc362cf2d8"><div class="ttname"><a href="structGrid.html#a1f52441a37442b054bf153cc362cf2d8">Grid::dx</a></div><div class="ttdeci">double dx</div><div class="ttdoc">Grid spacing in each direction (constant throughout the domain).</div><div class="ttdef"><b>Definition:</b> Grid.hpp:27</div></div>
<div class="ttc" id="astructGrid_html_a229d6a7322d5d4ff446fd78468fef27b"><div class="ttname"><a href="structGrid.html#a229d6a7322d5d4ff446fd78468fef27b">Grid::dz</a></div><div class="ttdeci">double dz</div><div class="ttdef"><b>Definition:</b> Grid.hpp:27</div></div>
<div class="ttc" id="astructGrid_html_a374223708b014cc2b96c2e6e5ef4abf7"><div class="ttname"><a href="structGrid.html#a374223708b014cc2b96c2e6e5ef4abf7">Grid::Grid</a></div><div class="ttdeci">Grid(size_t Nx_g, size_t Ny_g, size_t Nz_g, double dx_, double dy_, double dz_)</div><div class="ttdoc">Constructor to initialize the grid in an explicitly sequential environment.</div><div class="ttdef"><b>Definition:</b> Grid.cpp:3</div></div>
<div class="ttc" id="astructGrid_html_a513f0485d5d237374e53449b2c656d1a"><div class="ttname"><a href="structGrid.html#a513f0485d5d237374e53449b2c656d1a">Grid::Ny_glob</a></div><div class="ttdeci">size_t Ny_glob</div><div class="ttdef"><b>Definition:</b> Grid.hpp:25</div></div>
<div class="ttc" id="astructGrid_html_a5165f82a832d9b1c2bd2156c3b6439d6"><div class="ttname"><a href="structGrid.html#a5165f82a832d9b1c2bd2156c3b6439d6">Grid::Nz</a></div><div class="ttdeci">size_t Nz</div><div class="ttdef"><b>Definition:</b> Grid.hpp:33</div></div>
<div class="ttc" id="astructGrid_html_a591f8df86fb8e8f7986919e108f478ee"><div class="ttname"><a href="structGrid.html#a591f8df86fb8e8f7986919e108f478ee">Grid::to_y</a></div><div class="ttdeci">double to_y(size_t j, GridStaggering offset, Axis offsetAxis) const</div><div class="ttdoc">Converts a grid index to a physical coordinate along the Y-axis, considering staggering.</div><div class="ttdef"><b>Definition:</b> Grid.hpp:120</div></div>
<div class="ttc" id="astructGrid_html_a6f37c8f735275a95c496ce0e9309c44a"><div class="ttname"><a href="structGrid.html#a6f37c8f735275a95c496ce0e9309c44a">Grid::i_start</a></div><div class="ttdeci">size_t i_start</div><div class="ttdoc">Index-offset in each dimension of this local grid chunk in the global grid.</div><div class="ttdef"><b>Definition:</b> Grid.hpp:35</div></div>
<div class="ttc" id="astructGrid_html_a730fde210b6d4dd0f38ad9e84b504851"><div class="ttname"><a href="structGrid.html#a730fde210b6d4dd0f38ad9e84b504851">Grid::Lx_glob</a></div><div class="ttdeci">double Lx_glob</div><div class="ttdoc">Physical lengths of the global grid in each direction.</div><div class="ttdef"><b>Definition:</b> Grid.hpp:23</div></div>
<div class="ttc" id="astructGrid_html_a781159ea5c1221fa762773382b2379be"><div class="ttname"><a href="structGrid.html#a781159ea5c1221fa762773382b2379be">Grid::Ly_glob</a></div><div class="ttdeci">double Ly_glob</div><div class="ttdef"><b>Definition:</b> Grid.hpp:23</div></div>
<div class="ttc" id="astructGrid_html_a78c04584375f91cfa978ea0c9f76c111"><div class="ttname"><a href="structGrid.html#a78c04584375f91cfa978ea0c9f76c111">Grid::n_halo</a></div><div class="ttdeci">size_t n_halo</div><div class="ttdoc">Number of halo points along each direction.</div><div class="ttdef"><b>Definition:</b> Grid.hpp:37</div></div>
<div class="ttc" id="astructGrid_html_a7f51b9f4262231b3e89f1b9169f83e1c"><div class="ttname"><a href="structGrid.html#a7f51b9f4262231b3e89f1b9169f83e1c">Grid::Nx</a></div><div class="ttdeci">size_t Nx</div><div class="ttdoc">Number of grid points in the local grid chunk in each direction (derived from global info and Cartesi...</div><div class="ttdef"><b>Definition:</b> Grid.hpp:33</div></div>
<div class="ttc" id="astructGrid_html_a8a5cf0c72f5be8a213d6e895494851e6"><div class="ttname"><a href="structGrid.html#a8a5cf0c72f5be8a213d6e895494851e6">Grid::globalSize</a></div><div class="ttdeci">constexpr size_t globalSize() const</div><div class="ttdoc">Getter for the total number of global grid points.</div><div class="ttdef"><b>Definition:</b> Grid.hpp:84</div></div>
<div class="ttc" id="astructGrid_html_aa028931255914c6030565b59d2ec1be6"><div class="ttname"><a href="structGrid.html#aa028931255914c6030565b59d2ec1be6">Grid::to_x</a></div><div class="ttdeci">double to_x(size_t i, GridStaggering offset, Axis offsetAxis) const</div><div class="ttdoc">Converts a grid index to a physical coordinate along the X-axis, considering staggering.</div><div class="ttdef"><b>Definition:</b> Grid.hpp:107</div></div>
<div class="ttc" id="astructGrid_html_aae9c0e8104091f55bd0c172a0d0ae081"><div class="ttname"><a href="structGrid.html#aae9c0e8104091f55bd0c172a0d0ae081">Grid::hasMinBoundary</a></div><div class="ttdeci">bool hasMinBoundary(Axis axis) const</div><div class="ttdoc">Checks if the local grid chunk has the minimum boundary at the specified axis.</div><div class="ttdef"><b>Definition:</b> Grid.hpp:144</div></div>
<div class="ttc" id="astructGrid_html_ab4073ab5f9f45cffcf9ec3059e61c5d3"><div class="ttname"><a href="structGrid.html#ab4073ab5f9f45cffcf9ec3059e61c5d3">Grid::k_start</a></div><div class="ttdeci">size_t k_start</div><div class="ttdef"><b>Definition:</b> Grid.hpp:35</div></div>
<div class="ttc" id="astructGrid_html_ac388777840b30765f83a8a135d7b0cec"><div class="ttname"><a href="structGrid.html#ac388777840b30765f83a8a135d7b0cec">Grid::dy</a></div><div class="ttdeci">double dy</div><div class="ttdef"><b>Definition:</b> Grid.hpp:27</div></div>
<div class="ttc" id="astructGrid_html_ac9b2a8eafa59fe957bd84b9d3f84df7f"><div class="ttname"><a href="structGrid.html#ac9b2a8eafa59fe957bd84b9d3f84df7f">Grid::decompose1D</a></div><div class="ttdeci">static std::pair&lt; size_t, size_t &gt; decompose1D(size_t N_glob, int n_procs, int proc_coord)</div><div class="ttdoc">Decompose the grid along a target dimension, identifying local information of the chunk owned by a pr...</div><div class="ttdef"><b>Definition:</b> Grid.cpp:44</div></div>
<div class="ttc" id="astructGrid_html_ad1c6b97e05c5dd3a7ae4c96d51b77c63"><div class="ttname"><a href="structGrid.html#ad1c6b97e05c5dd3a7ae4c96d51b77c63">Grid::Nz_glob</a></div><div class="ttdeci">size_t Nz_glob</div><div class="ttdef"><b>Definition:</b> Grid.hpp:25</div></div>
<div class="ttc" id="astructGrid_html_add6c8c9ea4bd708abfcbe875e85cd076"><div class="ttname"><a href="structGrid.html#add6c8c9ea4bd708abfcbe875e85cd076">Grid::size</a></div><div class="ttdeci">constexpr size_t size() const</div><div class="ttdoc">Getter for the total number of local grid points.</div><div class="ttdef"><b>Definition:</b> Grid.hpp:90</div></div>
<div class="ttc" id="astructGrid_html_adfd015b3978a3dd58f1fe4daa0567eb5"><div class="ttname"><a href="structGrid.html#adfd015b3978a3dd58f1fe4daa0567eb5">Grid::Lz_glob</a></div><div class="ttdeci">double Lz_glob</div><div class="ttdef"><b>Definition:</b> Grid.hpp:23</div></div>
<div class="ttc" id="astructGrid_html_ae445b63d1d6af03452f1ffeb2f622d3d"><div class="ttname"><a href="structGrid.html#ae445b63d1d6af03452f1ffeb2f622d3d">Grid::sizeWithHalo</a></div><div class="ttdeci">constexpr size_t sizeWithHalo() const</div><div class="ttdoc">Getter for the total number of local grid points, including halo points in each direction.</div><div class="ttdef"><b>Definition:</b> Grid.hpp:96</div></div>
<div class="ttc" id="astructGrid_html_aedbe6591ce1565b3bdece8af225e5015"><div class="ttname"><a href="structGrid.html#aedbe6591ce1565b3bdece8af225e5015">Grid::Ny</a></div><div class="ttdeci">size_t Ny</div><div class="ttdef"><b>Definition:</b> Grid.hpp:33</div></div>
<div class="ttc" id="astructGrid_html_afd10d881b59bee4831fffda719ca035a"><div class="ttname"><a href="structGrid.html#afd10d881b59bee4831fffda719ca035a">Grid::hasMaxBoundary</a></div><div class="ttdeci">bool hasMaxBoundary(Axis axis) const</div><div class="ttdoc">Checks if the local grid chunk has the maximum boundary at the specified axis.</div><div class="ttdef"><b>Definition:</b> Grid.hpp:155</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
